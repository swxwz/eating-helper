<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ­£å¿µé¥®é£ŸåŠ©æ‰‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { touch-action: manipulation; }
        .bg-zen { background: linear-gradient(135deg, #fff9f0 0%, #fff5e6 100%); }
    </style>
</head>
<body class="bg-zen min-h-screen flex flex-col font-sans text-gray-800">

    <div id="logHeader" class="sticky top-0 bg-white/80 backdrop-blur-md border-b border-orange-100 p-4 z-10">
        <p class="text-xs font-bold text-orange-400 uppercase tracking-wider mb-2">è¿›é£Ÿå¯Ÿè§‰æ—¥è®°</p>
        <div id="logList" class="space-y-1 max-h-24 overflow-y-auto text-sm italic text-gray-500">
            <p>ç‚¹å‡»â€œå¼€å§‹â€å¼€å¯ä¸€æ®µä¸“æ³¨çš„ç”¨é¤æ—¶å…‰...</p>
        </div>
    </div>

    <main class="flex-grow flex flex-col items-center justify-center px-6">
        
        <div id="startScreen" class="text-center animate-in fade-in duration-700">
            <div class="text-7xl mb-8">ğŸ²</div>
            <h1 class="text-2xl font-light mb-8 text-gray-600">å‡†å¤‡å¥½ç”¨å¿ƒäº«å—ç¾é£Ÿäº†å—ï¼Ÿ</h1>
            <button onclick="startEating()" class="bg-orange-500 hover:bg-orange-600 text-white w-20 h-20 rounded-full text-lg font-bold shadow-xl shadow-orange-200 transition-all active:scale-90">
                å¼€å§‹
            </button>
        </div>

        <div id="eatingScreen" class="hidden w-full max-w-sm text-center">
            <div id="timerDisplay" class="font-mono text-4xl font-thin text-orange-300 mb-12">00:00</div>
            
            <div class="mb-12 relative">
                <div class="absolute inset-0 bg-orange-200 rounded-full blur-3xl opacity-20 animate-pulse"></div>
                <div class="text-6xl relative animate-bounce duration-[2000ms]">ğŸ¥¢</div>
            </div>

            <div id="questionBox" class="hidden space-y-4 bg-white p-6 rounded-3xl shadow-xl border border-orange-50 shadow-orange-100/50">
                <p class="font-medium text-lg mb-4">ç›®å‰çš„é¥±è…¹æ„Ÿæ˜¯ï¼Ÿ</p>
                <div id="optionsContainer" class="grid grid-cols-1 gap-3"></div>
            </div>

            <button onclick="stopEating()" class="mt-20 text-gray-400 text-sm hover:text-orange-400 transition">
                ç»“æŸåƒé¥­
            </button>
        </div>
    </main>

    <script>
        let startTime, timerInterval, lastChoice = "";
        let isWaiting = false;

        function playSoftNotice(text) {
            const msg = new SpeechSynthesisUtterance(text || "è¯·é—®ä½ ç°åœ¨å‡ æˆé¥±äº†ï¼Ÿ");
            msg.rate = 0.8;
            msg.pitch = 1.1;
            msg.volume = 0.8;
            window.speechSynthesis.speak(msg);
        }

        function startEating() {
            // è§£å†³ç§»åŠ¨ç«¯è¯­éŸ³æ¿€æ´»
            playSoftNotice("ç”¨é¤å¼€å§‹ï¼Œç¥ä½ èƒƒå£å¥½");
            
            startTime = new Date();
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('eatingScreen').classList.remove('hidden');
            
            timerInterval = setInterval(() => {
                const diff = Math.floor((new Date() - startTime) / 1000);
                const m = String(Math.floor(diff / 60)).padStart(2, '0');
                const s = String(diff % 60).padStart(2, '0');
                document.getElementById('timerDisplay').innerText = `${m}:${s}`;
            }, 1000);

            // 3åˆ†é’Ÿåé¦–æ¬¡æé†’ (180000ms)
            setTimeout(triggerCheck, 180000);
        }

        function triggerCheck() {
            isWaiting = true;
            document.getElementById('questionBox').classList.remove('hidden');
            renderButtons();
            playSoftNotice();

            // æŸ”å’Œå¾ªç¯æé†’
            const loop = setInterval(() => {
                if(isWaiting) playSoftNotice("è¯·é€‰æ‹©ä½ çš„é¥±è…¹æ„Ÿ");
                else clearInterval(loop);
            }, 15000);
        }

        function renderButtons() {
            let opts = ["5æˆé¥±ä»¥ä¸‹", "5ï¼6æˆ", "6ï¼7æˆ", "7æˆä»¥ä¸Š"]; // é»˜è®¤
            if (lastChoice === "5ï¼6æˆ") opts = ["5ï¼6æˆ", "6ï¼7æˆ", "7ï¼8æˆ", "8æˆä»¥ä¸Š"];
            else if (lastChoice === "6ï¼7æˆ") opts = ["6ï¼7æˆ", "7ï¼8æˆ", "8ï¼9æˆ", "9æˆä»¥ä¸Š"];
            else if (lastChoice === "7ï¼8æˆ") opts = ["8ï¼9æˆ", "9æˆï¼10æˆ", "10æˆè¿‡é‡", "è¶…çº§è¿‡é‡"];
            else if (lastChoice === "8ï¼9æˆ" || lastChoice === "9æˆï¼10æˆ") opts = ["9æˆï¼10æˆ", "10æˆè¿‡é‡", "è¶…çº§è¿‡é‡"];
            else if (lastChoice === "10æˆè¿‡é‡") opts = ["10æˆè¿‡é‡", "è¶…çº§è¿‡é‡"];

            const container = document.getElementById('optionsContainer');
            container.innerHTML = '';
            opts.forEach(text => {
                const btn = document.createElement('button');
                btn.className = "w-full py-4 rounded-2xl border-2 border-orange-100 bg-orange-50/30 active:bg-orange-500 active:text-white transition-all font-medium";
                btn.innerText = text;
                btn.onclick = () => {
                    lastChoice = text;
                    isWaiting = false;
                    document.getElementById('questionBox').classList.add('hidden');
                    addLog(text);
                    if(text !== "è¶…çº§è¿‡é‡") setTimeout(triggerCheck, 120000); // 2åˆ†é’Ÿåå†æ¬¡æé†’
                };
                container.appendChild(btn);
            });
        }

        function addLog(val) {
            const diff = Math.floor((new Date() - startTime) / 1000);
            const timeStr = `${Math.floor(diff/60)}åˆ†${diff%60}ç§’`;
            const logList = document.getElementById('logList');
            if(logList.innerText.includes("ç‚¹å‡»â€œå¼€å§‹â€")) logList.innerHTML = "";
            logList.innerHTML = `<p class="animate-in slide-in-from-left duration-300">ğŸ“Œ ${timeStr}ï¼š<span class="text-orange-600 font-bold">${val}</span></p>` + logList.innerHTML;
        }

        function stopEating() {
            if(confirm("ç¡®å®šè¦ç»“æŸè¿™æ®µç”¨é¤æ—¶å…‰å—ï¼Ÿ")) location.reload();
        }
    </script>
</body>
</html>
